{% extends 'dashboards/base_dashboard.html' %}
{% block dashboard_content %}
<div class="p-4 lg:p-6">
  <div class="flex items-center justify-between mb-4">
    <h2 class="text-2xl font-semibold">Line Manager Dashboard</h2>
    <div class="flex items-center gap-2">
      <a href="/app/leaves/new/" class="px-3 py-2 bg-orange-600 text-white rounded text-sm">Create Leave</a>
      <a href="/admin/shifts/leaverequest/" class="px-3 py-2 bg-gray-800 text-white rounded text-sm">Manage Leaves</a>
    </div>
  </div>

  <div class="grid grid-cols-1 lg:grid-cols-3 gap-4">
    <div class="lg:col-span-2 space-y-4">
      <div class="bg-white rounded shadow p-4">
        <h3 class="font-semibold mb-3">Team Members</h3>
        <ul class="space-y-3">
          {% for member in team %}
            <li class="flex items-center justify-between p-3 border rounded">
              <div>
                <div class="font-medium">{{ member.get_full_name|default:member.username }}</div>
                <div class="text-sm text-gray-600">{{ member.email }} • {{ member.phone }}</div>
              </div>
              <div class="text-sm text-gray-500">{{ member.role }}</div>
            </li>
          {% empty %}
            <li class="text-gray-600">No team members assigned.</li>
          {% endfor %}
        </ul>
      </div>

      <div class="bg-white rounded shadow p-4">
        <h3 class="font-semibold mb-3">Recent Team Leaves</h3>
        <ul class="space-y-2 text-sm">
          {% for l in team_leaves %}
            <li class="p-2 border rounded">
              <div class="font-medium">{{ l.requester.get_full_name|default:l.requester.username }}</div>
              <div class="text-xs text-gray-600">{{ l.start_datetime|date:'Y-m-d' }} → {{ l.end_datetime|date:'Y-m-d' }} • {{ l.get_status_display }}</div>
            </li>
          {% empty %}
            <li class="text-gray-600">No recent leaves.</li>
          {% endfor %}
        </ul>
      </div>
    </div>

    <div class="space-y-4">
      {% include 'components/dashboard_transactions.html' %}

      <div class="bg-white rounded shadow p-4">
        <h3 class="font-semibold mb-2">Team Summary</h3>
        <div class="text-sm text-gray-700">
          Members: <span class="font-medium">{{ team|length }}</span>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}
